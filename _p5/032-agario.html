---
layout: p5
---
<script>
    const divSettings = document.querySelector('.settings');
    // let size, posX, posY;

    function makeLabel(name) {
        let newLabel = createSpan();
        newLabel.parent(divSettings);
        newLabel.html(name + "<br>");
        return;
    }

    function Blob(x, y, r) {
        this.pos = createVector(x, y);
        this.r = r;

        this.vel = createVector(0, 0);
        this.update = function () {
            var newVel = createVector(mouseX - width / 2, mouseY - width / 2);
            newVel.setMag(3);
            this.vel.lerp(newVel, 0.2);
            this.pos.add(this.vel);
            if (this.pos.x < -width) { this.pos.x = -width }
            if (this.pos.y < -height) { this.pos.y = -height }
            if (this.pos.x > width) { this.pos.x = width }
            if (this.pos.y > height) { this.pos.y = height }
        }

        this.eats = function (other) {
            var d = p5.Vector.dist(this.pos, other.pos);
            if (d < this.r + other.r) {
                var sum = PI * this.r * this.r + PI * other.r * other.r;
                if (this.r < 100) this.r = sqrt(sum / PI)

                return true;
            } else {
                return false;
            }
        }
        
        this.show = function () {
            
            ellipse(this.pos.x, this.pos.y, this.r * 2, this.r * 2);
        }
    }

    let blob
    let blobs = []
    let zoom = 1

    function restoreFood() {
        let n = new Blob(random(-width, width), random(-height, height), 16)
        blobs.push(n)
    }
    function setup() {
        createCanvas(windowWidth, windowHeight);
        // size = createSlider(5, 300, 10, 1);
        // posX = createSlider(0, width, width / 2, 1);
        // posY = createSlider(0, height, height / 2, 1);
        // size.parent(divSettings);
        // makeLabel("size");
        // posX.parent(divSettings);
        // makeLabel("posX");
        // posY.parent(divSettings);
        // makeLabel("posY");
        // textSize(15);
        strokeWeight(4)
        fill(random(255), random(255), random(255))

        blob = new Blob(0, 0, 64)

        for (let i = 0; i < 50; i++) {
            blobs[i] = new Blob(random(-width, width), random(-height, height), 16)
        }
        
    }
    
    function draw() {
        // let s = size.value();
        // let pX = posX.value();
        // let pY = posY.value();
        
        print(blob.r)
        background(0);
        translate(width / 2, height / 2)
        var newzoom = 64 / blob.r
        zoom = lerp(zoom, newzoom, 0.1)
        scale(zoom)
        translate(-blob.pos.x, -blob.pos.y)
        for (let i = -height * 2; i <= height * 2; i = i + 50) {
            stroke(100)
            strokeWeight(1)
            line(-width * 2, i, width * 2, i)
        }
        for (let i = -width * 2; i <= width * 2; i = i + 50) {
            stroke(100)
            strokeWeight(1)
            line(i, -height * 2, i, height * 2)
        }
    
        for (var i = blobs.length - 1; i >= 0; i--) {
            blobs[i].show()
            if (blob.eats(blobs[i])) {
                blobs.splice(i, 1)
                setTimeout(restoreFood, 200)
            }
        }
    
        blob.show()
        blob.update()
    }
    

    function windowResized() {
        resizeCanvas(windowWidth, windowHeight);
    }

    const settingsBtn = document.querySelector(".settings-btn");
    const settings = document.querySelector('.settings');
    settingsBtn.addEventListener('click', () => settings.classList.toggle('open-settings'));
</script>